CREATE TABLE IF NOT EXISTS `match` (
	id INT AUTO_INCREMENT PRIMARY KEY,
	home_team_id INT,
	home_team_score TINYINT UNSIGNED,
	away_team_id INT,
	away_team_score TINYINT UNSIGNED,
	tournament_id INT NOT NULL,
	match_date DATE,
	match_time TIME,
	match_order TINYINT UNSIGNED,
	waiting_home_team VARCHAR(255),
	waiting_away_team VARCHAR(255),
	home_team_extra_time_score TINYINT UNSIGNED,
	away_team_extra_time_score TINYINT UNSIGNED,
	home_team_penalty_score TINYINT UNSIGNED,
	away_team_penalty_score TINYINT UNSIGNED,
	round_id INT,
	round_order TINYINT UNSIGNED,
	stage_id INT,
	stage_order TINYINT UNSIGNED,
	home_set1_score TINYINT UNSIGNED,
	away_set1_score TINYINT UNSIGNED,
	home_set1_tiebreak TINYINT UNSIGNED,
	away_set1_tiebreak TINYINT UNSIGNED,
	home_set2_score TINYINT UNSIGNED,
	away_set2_score TINYINT UNSIGNED,
	home_set2_tiebreak TINYINT UNSIGNED,
	away_set2_tiebreak TINYINT UNSIGNED,
	home_set3_score TINYINT UNSIGNED,
	away_set3_score TINYINT UNSIGNED,
	home_set3_tiebreak TINYINT UNSIGNED,
	away_set3_tiebreak TINYINT UNSIGNED,
	home_set4_score TINYINT UNSIGNED,
	away_set4_score TINYINT UNSIGNED,
	home_set4_tiebreak TINYINT UNSIGNED,
	away_set4_tiebreak TINYINT UNSIGNED,
	home_set5_score TINYINT UNSIGNED,
	away_set5_score TINYINT UNSIGNED,
	home_set5_tiebreak TINYINT UNSIGNED,
	away_set5_tiebreak TINYINT UNSIGNED,
	FOREIGN KEY (home_team_id) REFERENCES team(id),
	FOREIGN KEY (away_team_id) REFERENCES team(id),
	FOREIGN KEY (tournament_id) REFERENCES tournament(id),
	FOREIGN KEY (round_id) REFERENCES `group`(id),
	FOREIGN KEY (stage_id) REFERENCES `group`(id)
);

ALTER TABLE `match`
	DROP COLUMN home_seed,
	DROP COLUMN away_seed;

INSERT INTO `match` (home_team_id, away_team_id, tournament_id, match_date, match_time, match_order, round_id, stage_id)
VALUES (23, 17, 1, '2018-06-14', '180000', 1, 41, 39),
	(8, 32, 1, '2018-06-15', '170000', 2, 41, 39),
	(4, 6, 1, '2018-06-15', '130000', 3, 41, 39),
	(9, 14, 1, '2018-06-15', '100000', 4, 41, 39),
	(21, 13, 1, '2018-06-16', '050000', 5, 41, 39),
	(31, 19, 1, '2018-06-16', '110000', 6, 41, 39),
	(3, 22, 1, '2018-06-16', '080000', 7, 41, 39),
	(18, 10, 1, '2018-06-16', '140000', 8, 41, 39),
	(1, 26, 1, '2018-06-17', '130000', 9, 41, 39),
	(27, 24, 1, '2018-06-17', '070000', 10, 41, 39),
	(2, 28, 1, '2018-06-17', '100000', 11, 41, 39),
	(25, 16, 1, '2018-06-18', '070000', 12, 41, 39),
	(5, 29, 1, '2018-06-18', '100000', 13, 41, 39),
	(12, 20, 1, '2018-06-18', '130000', 14, 41, 39),
	(7, 11, 1, '2018-06-19', '100000', 15, 41, 39),
	(30, 15, 1, '2018-06-19', '070000', 16, 41, 39),
	(23, 8, 1, '2018-06-19', '130000', 17, 41, 39),
	(32, 17, 1, '2018-06-20', '100000', 18, 41, 39),
	(4, 9, 1, '2018-06-20', '070000', 19, 41, 39),
	(14, 6, 1, '2018-06-20', '130000', 20, 41, 39),
	(21, 31, 1, '2018-06-21', '100000', 21, 41, 39),
	(19, 13, 1, '2018-06-21', '070000', 22, 41, 39),
	(3, 18, 1, '2018-06-21', '130000', 23, 41, 39),
	(10, 22, 1, '2018-06-22', '100000', 24, 41, 39),
	(1, 27, 1, '2018-06-22', '070000', 25, 41, 39),
	(24, 26, 1, '2018-06-22', '130000', 26, 41, 39),
	(2, 25, 1, '2018-06-23', '130000', 27, 41, 39),
	(16, 28, 1, '2018-06-23', '100000', 28, 41, 39),
	(5, 12, 1, '2018-06-23', '070000', 29, 41, 39),
	(20, 29, 1, '2018-06-24', '070000', 30, 41, 39),
	(7, 30, 1, '2018-06-24', '130000', 31, 41, 39),
	(15, 11, 1, '2018-06-24', '100000', 32, 41, 39),
	(32, 23, 1, '2018-06-25', '090000', 33, 41, 39),
	(17, 8, 1, '2018-06-25', '090000', 34, 41, 39),
	(14, 4, 1, '2018-06-25', '130000', 35, 41, 39),
	(6, 9, 1, '2018-06-25', '130000', 36, 41, 39),
	(19, 21, 1, '2018-06-26', '090000', 37, 41, 39),
	(13, 31, 1, '2018-06-26', '090000', 38, 41, 39),
	(10, 3, 1, '2018-06-26', '130000', 39, 41, 39),
	(22, 18, 1, '2018-06-26', '130000', 40, 41, 39),
	(24, 1, 1, '2018-06-27', '130000', 41, 41, 39),
	(26, 27, 1, '2018-06-27', '130000', 42, 41, 39),
	(16, 2, 1, '2018-06-27', '090000', 43, 41, 39),
	(28, 25, 1, '2018-06-27', '090000', 44, 41, 39),
	(20, 5, 1, '2018-06-28', '130000', 45, 41, 39),
	(29, 12, 1, '2018-06-28', '130000', 46, 41, 39),
	(15, 7, 1, '2018-06-28', '090000', 47, 41, 39),
	(11, 30, 1, '2018-06-28', '090000', 48, 41, 39);

INSERT INTO `match` (tournament_id, match_date, match_time, match_order, waiting_home_team, waiting_away_team, round_id, stage_id)
VALUES (1, '2018-06-30', '090000', 49, '1C', '2D', 42, 40),
	(1, '2018-06-30', '130000', 50, '1A', '2B', 42, 40),
	(1, '2018-07-01', '090000', 51, '1B', '2A', 42, 40),
	(1, '2018-07-01', '130000', 52, '1D', '2C', 42, 40),
	(1, '2018-07-02', '090000', 53, '1E', '2F', 42, 40),
	(1, '2018-07-02', '130000', 54, '1G', '2H', 42, 40),
	(1, '2018-07-03', '090000', 55, '1F', '2E', 42, 40),
	(1, '2018-07-03', '130000', 56, '1H', '2G', 42, 40),
	(1, '2018-07-06', '090000', 57, 'W49', 'W50', 43, 40),
	(1, '2018-07-06', '130000', 58, 'W53', 'W54', 43, 40),
	(1, '2018-07-07', '090000', 59, 'W55', 'W56', 43, 40),
	(1, '2018-07-07', '130000', 60, 'W51', 'W52', 43, 40),
	(1, '2018-07-10', '130000', 61, 'W57', 'W58', 44, 40),
	(1, '2018-07-11', '130000', 62, 'W59', 'W60', 44, 40),
	(1, '2018-07-14', '090000', 63, 'L61', 'L62', 45, 40),
	(1, '2018-07-15', '100000', 64, 'W61', 'W62', 46, 40);

INSERT INTO `match` (home_team_id, away_team_id, tournament_id, match_date, match_order, round_id,
	home_set1_score, away_set1_score, home_set1_tiebreak, away_set1_tiebreak,
	home_set2_score, away_set2_score, home_set2_tiebreak, away_set2_tiebreak,
					 home_set3_score, away_set3_score, home_set3_tiebreak, away_set3_tiebreak,
					 home_set4_score, away_set4_score, home_set4_tiebreak, away_set4_tiebreak,
					 home_set5_score, away_set5_score, home_set5_tiebreak, away_set5_tiebreak)
VALUES (65, 66, 4, '2017-08-29', 1, 47, 6, 2, NULL, NULL, 6, 2, NULL, NULL, 6, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(67, 68, 4, '2017-08-29', 2, 47, 6, 4, NULL, NULL, 6, 1, NULL, NULL, 6, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(69, 70, 4, '2017-08-29', 3, 47, 7, 6, 7, 2, 6, 4, NULL, NULL, 3, 6, NULL, NULL, 7, 6, 7, 4, NULL, NULL, NULL, NULL),
	(71, 72, 4, '2017-08-29', 4, 47, 6, 3, NULL, NULL, 2, 6, NULL, NULL, 4, 6, NULL, NULL, 2, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(73, 74, 4, '2017-08-29', 5, 47, 6, 4, NULL, NULL, 7, 6, 11, 9, 6, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(75, 76, 4, '2017-08-29', 6, 47, 6, 3, NULL, NULL, 1, 6, NULL, NULL, 6, 1, NULL, NULL, 6, 4, NULL, NULL, NULL, NULL, NULL, NULL),
	(77, 78, 4, '2017-08-29', 7, 47, 6, 7, 6, 8, 3, 6, NULL, NULL, 4, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(79, 80, 4, '2017-08-29', 8, 47, 6, 1, NULL, NULL, 4, 6, NULL, NULL, 4, 6, NULL, NULL, 6, 2, NULL, NULL, 6, 2, NULL, NULL),
	(81, 82, 4, '2017-08-29', 9, 47, 3, 6, NULL, NULL, 6, 3, NULL, NULL, 6, 2, NULL, NULL, 1, 6, NULL, NULL, 6, 3, NULL, NULL),
	(83, 84, 4, '2017-08-29', 10, 47, 6, 4, NULL, NULL, 6, 2, NULL, NULL, 7, 6, 7, 4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(85, 86, 4, '2017-08-29', 11, 47, 3, 6, NULL, NULL, 7, 5, NULL, NULL, 4, 6, NULL, NULL, 3, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(87, 88, 4, '2017-08-29', 12, 47, 2, 6, NULL, NULL, 4, 6, NULL, NULL, 2, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(89, 90, 4, '2017-08-29', 13, 47, 5, 7, NULL, NULL, 6, 7, 3, 7, 1, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(91, 92, 4, '2017-08-29', 14, 47, 4, 6, NULL, NULL, 4, 6, NULL, NULL, 3, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(93, 94, 4, '2017-08-29', 15, 47, 6, 3, NULL, NULL, 3, 6, NULL, NULL, 6, 3, NULL, NULL, 4, 6, NULL, NULL, 3, 6, NULL, NULL),
	(95, 96, 4, '2017-08-29', 16, 47, 4, 6, NULL, NULL, 6, 7, 3, 7, 6, 7, 5, 7, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(97, 98, 4, '2017-08-29', 17, 47, 4, 6, NULL, NULL, 6, 7, 8, 10, 6, 3, NULL, NULL, 0, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(99, 100, 4, '2017-08-29', 18, 47, 5, 7, NULL, NULL, 6, 3, NULL, NULL, 6, 1, NULL, NULL, 6, 1, NULL, NULL, NULL, NULL, NULL, NULL),
	(101, 102, 4, '2017-08-29', 19, 47, 4, 6, NULL, NULL, 6, 2, NULL, NULL, 4, 6, NULL, NULL, 2, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(103, 104, 4, '2017-08-29', 20, 47, 3, 6, NULL, NULL, 6, 1, NULL, NULL, 4, 6, NULL, NULL, 1, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(105, 106, 4, '2017-08-29', 21, 47, 7, 6, 7, 5, 4, 6, NULL, NULL, 6, 3, NULL, NULL, 5, 7, NULL, NULL, 6, 4, NULL, NULL),
	(107, 108, 4, '2017-08-29', 22, 47, 1, 6, NULL, NULL, 2, 6, NULL, NULL, 0, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(109, 110, 4, '2017-08-29', 23, 47, 1, 6, NULL, NULL, 4, 6, NULL, NULL, 4, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(111, 112, 4, '2017-08-29', 24, 47, 6, 1, NULL, NULL, 6, 4, NULL, NULL, 6, 2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(113, 114, 4, '2017-08-29', 25, 47, 6, 7, 6, 8, 2, 6, NULL, NULL, 2, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(115, 116, 4, '2017-08-29', 26, 47, 4, 6, NULL, NULL, 6, 7, 4, 7, 7, 6, 7, 5, 2, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(117, 118, 4, '2017-08-29', 27, 47, 2, 6, NULL, NULL, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(119, 120, 4, '2017-08-29', 28, 47, 6, 1, NULL, NULL, 6, 0, NULL, NULL, 4, 6, NULL, NULL, 4, 6, NULL, NULL, 6, 4, NULL, NULL),
	(121, 122, 4, '2017-08-29', 29, 47, 6, 1, NULL, NULL, 6, 4, NULL, NULL, 6, 4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(123, 124, 4, '2017-08-29', 30, 47, 4, 6, NULL, NULL, 3, 6, NULL, NULL, 2, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(125, 126, 4, '2017-08-29', 31, 47, 6, 2, NULL, NULL, 4, 6, NULL, NULL, 6, 2, NULL, NULL, 7, 6, 7, 1, NULL, NULL, NULL, NULL),
	(127, 128, 4, '2017-08-29', 32, 47, 4, 6, NULL, NULL, 6, 2, NULL, NULL, 6, 1, NULL, NULL, 1, 6, NULL, NULL, 6, 4, NULL, NULL),
	(129, 130, 4, '2017-08-28', 33, 47, 3, 6, NULL, NULL, 7, 6, 10, 8, 6, 4, NULL, NULL, 6, 3, NULL, NULL, NULL, NULL, NULL, NULL),
	(131, 132, 4, '2017-08-28', 34, 47, 6, 3, NULL, NULL, 7, 5, NULL, NULL, 6, 3, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(133, 134, 4, '2017-08-28', 35, 47, 4, 6, NULL, NULL, 6, 7, 2, 7, 6, 7, 5, 7, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(135, 136, 4, '2017-08-28', 36, 47, 6, 3, NULL, NULL, 6, 2, NULL, NULL, 7, 6, 7, 5, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(137, 138, 4, '2017-08-28', 37, 47, 5, 7, NULL, NULL, 6, 0, NULL, NULL, 3, 6, NULL, NULL, 4, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(139, 140, 4, '2017-08-28', 38, 47, 6, 7, 7, 9, 1, 6, NULL, NULL, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(141, 142, 4, '2017-08-28', 39, 47, 6, 3, NULL, NULL, 6, 3, NULL, NULL, 6, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(143, 144, 4, '2017-08-28', 40, 47, 2, 6, NULL, NULL, 1, 6, NULL, NULL, 3, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(145, 146, 4, '2017-08-28', 41, 47, 3, 6, NULL, NULL, 3, 6, NULL, NULL, 4, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(147, 148, 4, '2017-08-28', 42, 47, 7, 6, 7, 3, 5, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(149, 150, 4, '2017-08-28', 43, 47, 7, 5, NULL, NULL, 4, 6, NULL, NULL, 6, 2, NULL, NULL, 6, 4, NULL, NULL, NULL, NULL, NULL, NULL),
	(151, 152, 4, '2017-08-28', 44, 47, 4, 6, NULL, NULL, 7, 6, 7, 3, 2, 6, 5, 7, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(153, 154, 4, '2017-08-28', 45, 47, 1, 6, NULL, NULL, 3, 6, NULL, NULL, 6, 4, NULL, NULL, 3, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(155, 156, 4, '2017-08-28', 46, 47, 6, 4, NULL, NULL, 3, 6, NULL, NULL, 2, 6, NULL, NULL, 1, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(157, 158, 4, '2017-08-28', 47, 47, 6, 4, NULL, NULL, 2, 6, NULL, NULL, 3, 6, NULL, NULL, 3, 6, NULL, NULL, NULL, NULL, NULL, NULL),
	(159, 160, 4, '2017-08-28', 48, 47, 3, 6, NULL, NULL, 2, 6, NULL, NULL, 6, 7, 5, 7, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(161, 162, 4, '2017-08-28', 49, 47, 6, 4, NULL, NULL, 6, 3, NULL, NULL, 3, 6, NULL, NULL, 6, 3, NULL, NULL, NULL, NULL, NULL, NULL),
	(163, 164, 4, '2017-08-28', 50, 47, 6, 4, NULL, NULL, 6, 7, 4, 7, 5, 7, NULL, NULL, 7, 6, 7, 3, 5, 7, NULL, NULL),
	(164, 166, 4, '2017-08-28', 51, 47, 7, 6, 7, 5, 4, 6, NULL, NULL, 4, 6, NULL, NULL, 7, 5, NULL, NULL, 6, 3, NULL, NULL),
	(167, 168, 4, '2017-08-28', 52, 47, 4, 6, NULL, NULL, 6, 3, NULL, NULL, 7, 6, 7, 4, 6, 2, NULL, NULL, NULL, NULL, NULL, NULL),
	(169, 170, 4, '2017-08-28', 53, 47, 6, 2, NULL, NULL, 6, 4, NULL, NULL, 6, 2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(171, 172, 4, '2017-08-28', 54, 47, 6, 4, NULL, NULL, 6, 3, NULL, NULL, 6, 4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(173, 174, 4, '2017-08-28', 55, 47, 3, 6, NULL, NULL, 6, 2, NULL, NULL, 4, 6, NULL, NULL, 6, 2, NULL, NULL, 6, 7, 3, 7),
	(175, 176, 4, '2017-08-28', 56, 47, 5, 7, NULL, NULL, 1, 6, NULL, NULL, 2, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(177, 178, 4, '2017-08-28', 57, 47, 0, 6, NULL, NULL, 6, 4, NULL, NULL, 3, 6, NULL, NULL, 6, 7, 6, 8, NULL, NULL, NULL, NULL),
	(179, 180, 4, '2017-08-28', 58, 47, 3, 6, NULL, NULL, 4, 6, NULL, NULL, 4, 6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(181, 182, 4, '2017-08-28', 59, 47, 7, 6, 7, 5, 6, 3, NULL, NULL, 1, 6, NULL, NULL, 6, 7, 2, 7, 3, 6, NULL, NULL),
	(183, 184, 4, '2017-08-28', 60, 47, 3, 6, NULL, NULL, 6, 3, NULL, NULL, 6, 4, NULL, NULL, 6, 4, NULL, NULL, NULL, NULL, NULL, NULL),
	(185, 186, 4, '2017-08-28', 61, 47, 2, 6, NULL, NULL, 6, 7, 12, 14, 6, 1, NULL, NULL, 7, 5, NULL, NULL, 4, 6, NULL, NULL),
	(187, 188, 4, '2017-08-28', 62, 47, 7, 6, 11, 9, 7, 5, NULL, NULL, 6, 4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(189, 190, 4, '2017-08-28', 63, 47, 7, 6, 7, 5, 7, 6, 7, 2, 6, 2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
	(191, 192, 4, '2017-08-28', 64, 47, 7, 6, 7, 5, 6, 4, NULL, NULL, 3, 6, NULL, NULL, 7, 6, 7, 4, NULL, NULL, NULL, NULL);

SELECT t.name AS home_team_name, htt.seed AS home_team_seed,
	t2.name AS away_team_name, att.seed AS away_team_seed,
	home_set1_score, away_set1_score, home_set1_tiebreak, away_set1_tiebreak,
	home_set2_score, away_set2_score, home_set2_tiebreak, away_set2_tiebreak,
	home_set3_score, away_set3_score, home_set3_tiebreak, away_set3_tiebreak,
	home_set4_score, away_set4_score, home_set4_tiebreak, away_set4_tiebreak,
	home_set5_score, away_set5_score, home_set5_tiebreak, away_set5_tiebreak,
	match_date, match_order,
	g.name AS round,
	m.tournament_id
FROM `match` m
	LEFT JOIN team t ON t.id = m.home_team_id
	LEFT JOIN team t2 ON t2.id = m.away_team_id
	LEFT JOIN `group` g ON g.id = m.round_id
	LEFT JOIN team_tournament htt ON (htt.team_id = m.home_team_id AND htt.tournament_id = m.tournament_id)
	LEFT JOIN team_tournament att ON (att.team_id = m.away_team_id AND att.tournament_id = m.tournament_id)
WHERE m.tournament_id = 4
ORDER BY match_order;
